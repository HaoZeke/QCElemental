<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">


      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/small-apps.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/themefisher-font.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="AtomicResult" href="model_result.html" />
    <link rel="prev" title="Overview" href="models.html" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MZ67SSL');</script>
<!-- End Google Tag Manager -->
 

</head>

<body class="wy-body-for-nav">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MZ67SSL"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


<div style="width: 100%" class="qca-header">
<nav class="navbar main-nav navbar-expand-lg p-0 qca-header">
  <div class="container nav-width">
    <div class="logo-width">
    <a class="navbar-brand" href="https://docs.qcarchive.molssi.org"><img src="https://docs.qcarchive.molssi.org/en/latest/_static/images/QCAInfrastructure.png" alt="logo" width=200px></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
      aria-expanded="false" aria-label="Toggle navigation">
      <span class="tf-ion-android-menu"></span>
    </button>
    </div>
      <div class="collapse navbar-collapse" id=navbarNav>
         <ul class="navbar-nav ml-auto">
            <li class=nav-item>
                <a class=nav-link href=https://join.slack.com/t/qcarchive/shared_invite/enQtNDIzNTQ2OTExODk0LTE3MWI0YzBjNzVhNzczNDM0ZTA5MmQ1ODcxYTc0YTA1ZDQ2MTk1NDhlMjhjMmQ0YWYwOGMzYzJkZTM2NDlmOGM>
                Community Slack
                </a>
            </li>
            <li class=nav-item><a class=nav-link href=https://qcarchive.molssi.org></a></li>
            <li class="nav-item dropdown dropdown-slide">
               <a class=nav-link href=# data-toggle=dropdown>GitHub
               <span><i class=tf-ion-ios-arrow-down></i></span></a>
               <div class=dropdown-menu>
                  <a class=dropdown-item href=https://github.com/MolSSI/QCElemental>QCElemental</a>
                  <a class=dropdown-item href=https://github.com/MolSSI/QCEngine>QCEngine</a>
                  <a class=dropdown-item href=https://github.com/MolSSI/QCFractal>QCFractal</a>
                  <a class=dropdown-item href=https://github.com/MolSSI/QCFractal>QCPortal</a>
               </div>
            </li>
            <li class="nav-item dropdown dropdown-slide">
               <a class=nav-link href=# data-toggle=dropdown>Documentation
               <span><i class=tf-ion-ios-arrow-down></i></span></a>
               <div class=dropdown-menu>
                  <a class=dropdown-item href=https://docs.qcarchive.molssi.org/>Examples</a>
                  <a class=dropdown-item href=https://docs.qcarchive.molssi.org/projects/QCElemental/en/stable>QCElemental</a>
                  <a class=dropdown-item href=https://docs.qcarchive.molssi.org/projects/QCEngine/en/stable>QCEngine</a>
                  <a class=dropdown-item href=https://docs.qcarchive.molssi.org/projects/QCFractal/en/stable>QCFractal</a>
                  <a class=dropdown-item href=https://docs.qcarchive.molssi.org/projects/QCPortal/en/stable>QCPortal</a>
               </div>
            </li>
            <li class=nav-item><a class=nav-link href=https://qcarchive.molssi.org/><u>MolSSI Database</u></a></li>
         </ul>
      </div>
   </div>
   </div>
</nav>




  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> QCElemental
          </a>
              <div class="version">
                0+untagged.1.ga5885ee
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install QCElemental</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quantities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="physconst.html">Physical Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="periodic_table.html">Periodic Table</a></li>
<li class="toctree-l1"><a class="reference internal" href="covalent_radii.html">Covalent Radii</a></li>
<li class="toctree-l1"><a class="reference internal" href="vanderwaals_radii.html">van der Waals Radii</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">QCSchema Models</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="models.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Molecule</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creation">Creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#identifiers">Identifiers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#molecular-hash">Molecular Hash</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molecular-formula">Molecular Formula</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fragments">Fragments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fields">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model_result.html">AtomicResult</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_common.html">Common</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">QCElemental API</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QCElemental</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Molecule</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/model_molecule.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="molecule">
<h1>Molecule<a class="headerlink" href="#molecule" title="Permalink to this headline"></a></h1>
<p>A Python implementation of the <a class="reference external" href="https://github.com/MolSSI/QCSchema">MolSSI QCSchema</a> <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> object.
There are many definitions of <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> depending on the domain; this particular
<code class="docutils literal notranslate"><span class="pre">Molecule</span></code> is an immutable 3D Cartesian representation with support for
quantum chemistry constructs.</p>
<section id="creation">
<h2>Creation<a class="headerlink" href="#creation" title="Permalink to this headline"></a></h2>
<p>A Molecule can be created using the normal kwargs fashion as shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">qcel</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;symbols&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">],</span> <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
</pre></div>
</div>
<p>In addition, there is the <code class="docutils literal notranslate"><span class="pre">from_data</span></code> attribute to create a molecule from standard strings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">qcel</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="s2">&quot;He 0 0 0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span>
<span class="go">&lt;    Geometry (in Angstrom), charge = 0.0, multiplicity = 1:</span>

<span class="go">       Center              X                  Y                   Z</span>
<span class="go">    ------------   -----------------  -----------------  -----------------</span>
<span class="go">    He                0.000000000000     0.000000000000     0.000000000000</span>
<span class="go">&gt;</span>
</pre></div>
</div>
</section>
<section id="identifiers">
<h2>Identifiers<a class="headerlink" href="#identifiers" title="Permalink to this headline"></a></h2>
<p>A number of unique identifiers are automatically created for each molecule.
Additional implementation such as InChI and SMILES are actively being looked
into.</p>
<section id="molecular-hash">
<h3>Molecular Hash<a class="headerlink" href="#molecular-hash" title="Permalink to this headline"></a></h3>
<p>A molecule hash is automatically created to allow each molecule to be uniquely
identified. The following keys are used to generate the hash:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">symbols</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">masses</span></code> (1.e-6 tolerance)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">molecular_charge</span></code> (1.e-4 tolerance)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">molecular_multiplicity</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">real</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geometry</span></code> (1.e-8 tolerance)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fragments</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fragment_charges</span></code> (1.e-4 tolerance)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fragment_multiplicities</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">connectivity</span></code></p></li>
</ul>
<p>Hashes can be acquired from any molecule object and a <code class="docutils literal notranslate"><span class="pre">FractalServer</span></code>
automatically generates canonical hashes when a molecule is added to the
database.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">qcel</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;symbols&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">,</span> <span class="s2">&quot;He&quot;</span><span class="p">],</span> <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">get_hash</span><span class="p">()</span>
<span class="go">&#39;84872f975d19aafa62b188b40fbadaf26a3b1f84&#39;</span>
</pre></div>
</div>
</section>
<section id="molecular-formula">
<h3>Molecular Formula<a class="headerlink" href="#molecular-formula" title="Permalink to this headline"></a></h3>
<p>The molecular formula is also available sorted in alphabetical order with
title case symbol names. Any symbol with a count of one does not have a number
associated with it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">get_molecular_formula</span><span class="p">()</span>
<span class="go">    &#39;He2&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="fragments">
<h2>Fragments<a class="headerlink" href="#fragments" title="Permalink to this headline"></a></h2>
<p>A Molecule with fragments can be created either using the <code class="docutils literal notranslate"><span class="pre">--</span></code> separators in
the <code class="docutils literal notranslate"><span class="pre">from_data</span></code> function or by passing explicit fragments in the
<code class="docutils literal notranslate"><span class="pre">Molecule</span></code> constructor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">qcel</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="sd">&quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">      Ne 0.000000 0.000000 0.000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">      --</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">      Ne 3.100000 0.000000 0.000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">      units au</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sd">      &quot;&quot;&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">qcel</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">geometry</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">,</span> <span class="s2">&quot;Ne&quot;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="n">fragments</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span>      <span class="p">)</span>
</pre></div>
</div>
<p>Fragments from a molecule containing fragment information can be acquired by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">get_fragment</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&lt;    Geometry (in Angstrom), charge = 0.0, multiplicity = 1:</span>

<span class="go">       Center              X                  Y                   Z</span>
<span class="go">    ------------   -----------------  -----------------  -----------------</span>
<span class="go">    Ne                0.000000000000     0.000000000000     0.000000000000</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<p>Obtaining fragments with ghost atoms is also supported:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">get_fragment</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&lt;    Geometry (in Angstrom), charge = 0.0, multiplicity = 1:</span>

<span class="go">       Center              X                  Y                   Z</span>
<span class="go">    ------------   -----------------  -----------------  -----------------</span>
<span class="go">    Ne                0.000000000000     0.000000000000     0.000000000000</span>
<span class="go">    Ne      (Gh)      3.100000000572     0.000000000000     0.000000000000</span>
<span class="go">&gt;</span>
</pre></div>
</div>
</section>
<section id="fields">
<h2>Fields<a class="headerlink" href="#fields" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="qcelemental.models.Molecule">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">qcelemental.models.</span></span><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qcelemental.models.Molecule" title="Permalink to this definition"></a></dt>
<dd><p>The physical Cartesian representation of the molecular system.</p>
<p>A QCSchema representation of a Molecule. This model contains
data for symbols, geometry, connectivity, charges, fragmentation, etc while also supporting a wide array of I/O and manipulation capabilities.</p>
<p>Molecule objects geometry, masses, and charges are truncated to 8, 6, and 4 decimal places respectively to assist with duplicate detection.</p>
<p class="rubric">Notes</p>
<p>All arrays are stored flat but must be reshapable into the dimensions in attribute <code class="docutils literal notranslate"><span class="pre">shape</span></code>, with abbreviations as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>nat: number of atomic = calcinfo_natom</p></li>
<li><p>nfr: number of fragments</p></li>
<li><p>&lt;varies&gt;: irregular dimension not systematically reshapable</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orient</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </p></li>
<li><p><strong>validate</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>]</em>) – </p></li>
<li><p><strong>schema_name</strong> (<em>qcelemental.models.molecule.ConstrainedStrValue</em>) – </p></li>
<li><p><strong>schema_version</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – </p></li>
<li><p><strong>validated</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </p></li>
<li><p><strong>symbols</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>geometry</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>identifiers</strong> (<em>Optional</em><em>[</em><em>qcelemental.models.molecule.Identifiers</em><em>]</em>) – </p></li>
<li><p><strong>comment</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>molecular_charge</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – </p></li>
<li><p><strong>molecular_multiplicity</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – </p></li>
<li><p><strong>masses</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>real</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>atom_labels</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>atomic_numbers</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>mass_numbers</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>connectivity</strong> (<em>types.ConstrainedListValue</em><em>[</em><em>Tuple</em><em>[</em><em>qcelemental.models.molecule.NonnegativeInt</em><em>, </em><em>qcelemental.models.molecule.NonnegativeInt</em><em>, </em><em>qcelemental.models.molecule.BondOrderFloat</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>fragments</strong> (<em>List</em><em>[</em><em>qcelemental.models.types.Array</em><em>]</em>) – </p></li>
<li><p><strong>fragment_charges</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>]</em>) – </p></li>
<li><p><strong>fragment_multiplicities</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>]</em>) – </p></li>
<li><p><strong>fix_com</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </p></li>
<li><p><strong>fix_orientation</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </p></li>
<li><p><strong>fix_symmetry</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>provenance</strong> (<a class="reference internal" href="model_common.html#qcelemental.models.Provenance" title="qcelemental.models.common_models.Provenance"><em>qcelemental.models.common_models.Provenance</em></a>) – </p></li>
<li><p><strong>id</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – </p></li>
<li><p><strong>extras</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.7/library/constants.html#None" title="(in Python v3.7)">None</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">qcelemental.models.</span></span><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>The physical Cartesian representation of the molecular system.</p>
<p>A QCSchema representation of a Molecule. This model contains
data for symbols, geometry, connectivity, charges, fragmentation, etc while also supporting a wide array of I/O and manipulation capabilities.</p>
<p>Molecule objects geometry, masses, and charges are truncated to 8, 6, and 4 decimal places respectively to assist with duplicate detection.</p>
<p class="rubric">Notes</p>
<p>All arrays are stored flat but must be reshapable into the dimensions in attribute <code class="docutils literal notranslate"><span class="pre">shape</span></code>, with abbreviations as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>nat: number of atomic = calcinfo_natom</p></li>
<li><p>nfr: number of fragments</p></li>
<li><p>&lt;varies&gt;: irregular dimension not systematically reshapable</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orient</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </p></li>
<li><p><strong>validate</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>]</em>) – </p></li>
<li><p><strong>schema_name</strong> (<em>qcelemental.models.molecule.ConstrainedStrValue</em>) – </p></li>
<li><p><strong>schema_version</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – </p></li>
<li><p><strong>validated</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </p></li>
<li><p><strong>symbols</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>geometry</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>name</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>identifiers</strong> (<em>Optional</em><em>[</em><em>qcelemental.models.molecule.Identifiers</em><em>]</em>) – </p></li>
<li><p><strong>comment</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>molecular_charge</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – </p></li>
<li><p><strong>molecular_multiplicity</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – </p></li>
<li><p><strong>masses</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>real</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>atom_labels</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>atomic_numbers</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>mass_numbers</strong> (<em>qcelemental.models.types.Array</em>) – </p></li>
<li><p><strong>connectivity</strong> (<em>types.ConstrainedListValue</em><em>[</em><em>Tuple</em><em>[</em><em>qcelemental.models.molecule.NonnegativeInt</em><em>, </em><em>qcelemental.models.molecule.NonnegativeInt</em><em>, </em><em>qcelemental.models.molecule.BondOrderFloat</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>fragments</strong> (<em>List</em><em>[</em><em>qcelemental.models.types.Array</em><em>]</em>) – </p></li>
<li><p><strong>fragment_charges</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>]</em>) – </p></li>
<li><p><strong>fragment_multiplicities</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>]</em>) – </p></li>
<li><p><strong>fix_com</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </p></li>
<li><p><strong>fix_orientation</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </p></li>
<li><p><strong>fix_symmetry</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>provenance</strong> (<a class="reference internal" href="model_common.html#qcelemental.models.Provenance" title="qcelemental.models.common_models.Provenance"><em>qcelemental.models.common_models.Provenance</em></a>) – </p></li>
<li><p><strong>id</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – </p></li>
<li><p><strong>extras</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.7/library/constants.html#None" title="(in Python v3.7)">None</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">align</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_mol</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_resorting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols_align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_to_completion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uno_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_mirror</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generic_ghosts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.align"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Finds shift, rotation, and atom reordering of <cite>concern_mol</cite> (self)
that best aligns with <cite>ref_mol</cite>.</p>
<p>Wraps <code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.molutil.B787()</span></code> for <a class="reference internal" href="#qcelemental.models.Molecule" title="qcelemental.models.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">qcelemental.models.Molecule</span></code></a>.
Employs the Kabsch, Hungarian, and Uno algorithms to exhaustively locate
the best alignment for non-oriented, non-ordered structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_mol</strong> (<a class="reference internal" href="#qcelemental.models.Molecule" title="qcelemental.models.Molecule"><em>qcelemental.models.Molecule</em></a>) – Molecule to match.</p></li>
<li><p><strong>atoms_map</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether atom1 of <cite>ref_mol</cite> corresponds to atom1 of <cite>concern_mol</cite>, etc.
If true, specifying <cite>True</cite> can save much time.</p></li>
<li><p><strong>mols_align</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Union" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]) – Whether ref_mol and concern_mol have identical geometries
(barring orientation or atom mapping) and expected final RMSD = 0.
If <cite>True</cite>, procedure is truncated when RMSD condition met, saving time.
If float, RMSD tolerance at which search for alignment stops. If provided,
the alignment routine will throw an error if it fails to align
the molecule within the specified RMSD tolerance.</p></li>
<li><p><strong>do_plot</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Pops up a mpl plot showing before, after, and ref geometries.</p></li>
<li><p><strong>run_to_completion</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Run reorderings to completion (past RMSD = 0) even if unnecessary because
<cite>mols_align=True</cite>. Used to test worst-case timings.</p></li>
<li><p><strong>run_resorting</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Run the resorting machinery even if unnecessary because <cite>atoms_map=True</cite>.</p></li>
<li><p><strong>uno_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – TODO</p></li>
<li><p><strong>run_mirror</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Run alternate geometries potentially allowing best match to <cite>ref_mol</cite>
from mirror image of <cite>concern_mol</cite>. Only run if system confirmed to
be nonsuperimposable upon mirror reflection.</p></li>
<li><p><strong>generic_ghosts</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – When one or both molecules doesn’t have meaningful element info for ghosts (can happen
when harvesting from a printout with a generic ghost symbol), set this to True to
place all real=False atoms into the same space for alignment. Only allowed when
<code class="docutils literal notranslate"><span class="pre">atoms_map=True</span></code>.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Print level.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Tuple" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference internal" href="#qcelemental.models.Molecule" title="qcelemental.models.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Any" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>mol</strong> (<em>Molecule</em>)</p></li>
<li><p><strong>data</strong> (<em>Dict[key, Any]</em>) – Molecule is internal geometry of <cite>self</cite> optimally aligned and atom-ordered
to <cite>ref_mol</cite>. Presently all fragment information is discarded.
<cite>data[‘rmsd’]</cite> is RMSD [A] between <cite>ref_mol</cite> and the optimally aligned
geometry computed.
<cite>data[‘mill’]</cite> is a AlignmentMill with fields
(shift, rotation, atommap, mirror) that prescribe the transformation
from <cite>concern_mol</cite> and the optimally aligned geometry.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Compares the current object to the provided object recursively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>Model</em>) – The model to compare to.</p></li>
<li><p><strong>**kwargs</strong> – Additional kwargs to pass to <code class="docutils literal notranslate"><span class="pre">qcelemental.compare_recursive</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the objects match.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">from_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.from_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Constructs a molecule object from a data structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Union" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Any" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#bytes" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>]) – Data to construct Molecule from</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – How to interpret the data, if not passed attempts to discover this based on input type.</p></li>
<li><p><strong>orient</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Orientates the molecule to a standard frame or not.</p></li>
<li><p><strong>validate</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]) – Validates the molecule or not.</p></li>
<li><p><strong>**kwargs</strong> – Additional kwargs to pass to the constructors. kwargs take precedence over data.</p></li>
<li><p><strong>kwargs</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A constructed molecule class.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#qcelemental.models.Molecule" title="qcelemental.models.Molecule">Molecule</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Constructs a molecule object from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – The filename to build</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – The type of file to interpret.</p></li>
<li><p><strong>orient</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Orientates the molecule to a standard frame or not.</p></li>
<li><p><strong>**kwargs</strong> – Any additional keywords to pass to the constructor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A constructed molecule class.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#qcelemental.models.Molecule" title="qcelemental.models.Molecule">Molecule</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_fragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ghost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_fragments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.get_fragment"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get new Molecule with fragments preserved, dropped, or ghosted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>real</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Union" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.List" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>]) – Fragment index or list of indices (0-indexed) to be real atoms in new Molecule.</p></li>
<li><p><strong>ghost</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Union" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.List" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]) – Fragment index or list of indices (0-indexed) to be ghost atoms (basis fns only) in new Molecule.</p></li>
<li><p><strong>orient</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether or not to align (inertial frame) and phase geometry upon new Molecule instantiation
(according to _orient_molecule_internal)?</p></li>
<li><p><strong>group_fragments</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether or not to group real fragments at the start of the atom list and ghost fragments toward the back.
Previous to <code class="docutils literal notranslate"><span class="pre">v0.5</span></code>, this was always effectively True. True is handy for finding duplicate
(atom-order-independent) molecules by hash. False preserves fragment order (though collapsing gaps for
absent fragments) like Psi4’s <code class="docutils literal notranslate"><span class="pre">extract_subsets</span></code>. False is handy for gradients where atom order of
returned values matters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New qcelemental.models.Molecule with <code class="docutils literal notranslate"><span class="pre">self</span></code>'s fragments present, ghosted, or absent.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#qcelemental.models.Molecule" title="qcelemental.models.Molecule">Molecule</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_hash</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.get_hash"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns the hash of the molecule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_molecular_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'alphabetical'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.get_molecular_formula"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns the molecular formula for a molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – Sorting order of the formula. Valid choices are “alphabetical” and “hill”.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecular formula.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)">str</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">methane</span> <span class="o">=</span> <span class="n">qcelemental</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">H      0.5288      0.1610      0.9359</span>
<span class="gp">... </span><span class="s1">C      0.0000      0.0000      0.0000</span>
<span class="gp">... </span><span class="s1">H      0.2051      0.8240     -0.6786</span>
<span class="gp">... </span><span class="s1">H      0.3345     -0.9314     -0.4496</span>
<span class="gp">... </span><span class="s1">H     -1.0685     -0.0537      0.1921</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">methane</span><span class="o">.</span><span class="n">get_molecular_formula</span><span class="p">()</span>
<span class="go">CH4</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hcl</span> <span class="o">=</span> <span class="n">qcelemental</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">H      0.0000      0.0000      0.0000</span>
<span class="gp">... </span><span class="s1">Cl     0.0000      0.0000      1.2000</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hcl</span><span class="o">.</span><span class="n">get_molecular_formula</span><span class="p">()</span>
<span class="go">ClH</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">measurements</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degrees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Takes a measurement of the moleucle from the indicies provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>measurements</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Union" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.List" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.List" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.List" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]]) – Either a single list of indices or multiple. Return a distance, angle, or dihedral depending if
2, 3, or 4 indices is provided, respectively. Values are returned in Bohr (distance) or degree.</p></li>
<li><p><strong>degrees</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Returns degrees by default, radians otherwise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Either a value or list of the measured values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)">float</a>, List[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)">float</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">nelectrons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ifr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.nelectrons"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Number of electrons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ifr</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – If not <cite>None</cite>, only compute for the <cite>ifr</cite>-th (0-indexed) fragment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nelec</strong> – Number of electrons in entire molecule or in fragment.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">nuclear_repulsion_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ifr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.nuclear_repulsion_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Nuclear repulsion energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ifr</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – If not <cite>None</cite>, only compute for the <cite>ifr</cite>-th (0-indexed) fragment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nre</strong> – Nuclear repulsion energy in entire molecule or in fragment.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">orient_molecule</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.orient_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Centers the molecule and orients via inertia tensor before returning a new Molecule</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">pretty_print</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.pretty_print"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Print the molecule in Angstroms. Same as <code class="xref py py-func docutils literal notranslate"><span class="pre">print_out()</span></code> only always in Angstroms.
(method name in libmints is print_in_angstrom)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">scramble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_resort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_mirror</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_to_completion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_resorting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.scramble"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generate a Molecule with random or directed translation, rotation, and atom shuffling.
Optionally, check that the aligner returns the opposite transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_mol</strong> (<a class="reference internal" href="#qcelemental.models.Molecule" title="qcelemental.models.Molecule"><em>qcelemental.models.Molecule</em></a>) – Molecule to perturb.</p></li>
<li><p><strong>do_shift</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Union" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.List" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>]) – Whether to generate a random atom shift on interval [-3, 3) in each
dimension (<cite>True</cite>) or leave at current origin. To shift by a specified
vector, supply a 3-element list.</p></li>
<li><p><strong>do_rotate</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Union" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.List" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.List" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>]]) – Whether to generate a random 3D rotation according to algorithm of Arvo.
To rotate by a specified matrix, supply a 9-element list of lists.</p></li>
<li><p><strong>do_resort</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Union" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.List" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>]) – Whether to shuffle atoms (<cite>True</cite>) or leave 1st atom 1st, etc. (<cite>False</cite>).
To specify shuffle, supply a nat-element list of indices.</p></li>
<li><p><strong>deflection</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#float" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – If <cite>do_rotate</cite>, how random a rotation: 0.0 is no change, 0.1 is small
perturbation, 1.0 is completely random.</p></li>
<li><p><strong>do_mirror</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to construct the mirror image structure by inverting y-axis.</p></li>
<li><p><strong>do_plot</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Pops up a mpl plot showing before, after, and ref geometries.</p></li>
<li><p><strong>do_test</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Additionally, run the aligner on the returned Molecule and check that
opposite transformations obtained.</p></li>
<li><p><strong>run_to_completion</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – By construction, scrambled systems are fully alignable (final RMSD=0).
Even so, <cite>True</cite> turns off the mechanism to stop when RMSD reaches zero
and instead proceed to worst possible time.</p></li>
<li><p><strong>run_resorting</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Even if atoms not shuffled, test the resorting machinery.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Print level.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Tuple" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference internal" href="#qcelemental.models.Molecule" title="qcelemental.models.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Any" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>mol</strong> (<em>Molecule</em>)</p></li>
<li><p><strong>data</strong> (<em>Dict[key, Any]</em>) – Molecule is scrambled copy of <cite>ref_mol</cite> (self).
<cite>data[‘rmsd’]</cite> is RMSD [A] between <cite>ref_mol</cite> and the scrambled geometry.
<cite>data[‘mill’]</cite> is a AlignmentMill with fields
(shift, rotation, atommap, mirror) that prescribe the transformation
from <cite>ref_mol</cite> to the returned geometry.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.7/library/exceptions.html#AssertionError" title="(in Python v3.7)"><strong>AssertionError</strong></a> – If <cite>do_test=True</cite> and aligner sanity check fails for any of the reverse
    transformations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngl_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Creates a 3D representation of a molecule that can be manipulated in Jupyter Notebooks and exported as
images (<cite>.png</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ngl_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Any" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]) – Addition nglview NGLWidget kwargs</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A nglview view of the molecule</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nglview.NGLWidget</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Writes the Molecule to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – The filename to write to</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/typing.html#typing.Optional" title="(in Python v3.7)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – The type of file to write, attempts to infer dtype from the filename if not provided.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.7/library/constants.html#None" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ghost_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/models/molecule.html#Molecule.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns a string that can be used by a variety of programs.</p>
<p>Unclear if this will be removed or renamed to “to_psi4_string” in the future</p>
<p>Suggest psi4 –&gt; psi4frag and psi4 route to to_string</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – </p></li>
<li><p><strong>units</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>atom_format</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>ghost_format</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3.7/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – </p></li>
<li><p><strong>prec</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – </p></li>
<li><p><strong>return_data</strong> (<a class="reference external" href="https://docs.python.org/3.7/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="models.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="model_result.html" class="btn btn-neutral float-right" title="AtomicResult" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2021, The Molecular Sciences Software Institute.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>